stages:
  - prep
  - build
  - unit_test
  - integration_test

prep:
  stage: prep
  script:
    - ./ci_scripts/prep.sh
    - ./ci_scripts/packages.sh 0
#  artifacts:
#    paths:
#      - packages.tar
#    expire_in: 2 hour

spin:
  stage: build
  script:
    - ./ci_scripts/packages.sh 1
    - ./ci_scripts/prep.sh
    - ./tools/build_check.sh spin

mutex:
  stage: build
  script:
    - ./ci_scripts/packages.sh 1
    - ./ci_scripts/prep.sh
    - ./tools/build_check.sh mutex

ivshmem:
  stage: build
  script:
    - ./ci_scripts/packages.sh 1
    - ./ci_scripts/prep.sh
    - ./tools/build_check.sh ivshmem

build_controller_master:
  stage: integration_test
  script:
    - ./ci_scripts/packages.sh 1
    - ./ci_scripts/prep.sh
    - ./ci_scripts/build_controller.sh
