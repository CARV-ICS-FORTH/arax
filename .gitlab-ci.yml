stages:
  - prep
  - build
  - test

prep:
  stage: prep
  script:
    - ./ci_scripts/prep.sh
    - ./ci_scripts/packages.sh 0
  artifacts:
    paths:
      - packages.tar
    expire_in: 1 day

spin:
  stage: build
  script:
    - ./ci_scripts/packages.sh 1
    - ./tools/build_check.sh spin

mutex:
  stage: build
  script:
    - ./tools/build_check.sh mutex

ivshmem:
  stage: build
  script:
    - ./tools/build_check.sh ivshmem

build_controller_master:
  stage: test
  script:
    - ./ci_scripts/build_controller.sh
